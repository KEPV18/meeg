<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculate Hours</title>
</head>
<body>

  <!-- إضافة حقل إدخال لرقم الموظف -->
  <label for="employeeCode">رقم الموظف:</label>
  <input type="text" id="employeeCode">
  
  <!-- إضافة حقل إدخال لاسم الورقة -->
  <label for="sheetName">اسم الورقة:</label>
  <input type="text" id="sheetName">

  <!-- زر لتنفيذ البحث -->
  <button onclick="calculateHours()">حساب الساعات</button>

  <!-- عرض النتيجة -->
  <p id="result"></p>

  <script>
    function calculateHours() {
    var spreadsheetId = "15TI7wC8qRSCK2hk32bWTOggEa54p3RYE_9aPQXTilAc";
    var apiKey = "AIzaSyA1DiDSTDT-E1KtlFhUpeecLxnKh_Uxxf8";

    // استبدال ME547429@meti.ai بالقيمة المستخدمة من حقل إدخال رقم الموظف
    var employeeCode = document.getElementById("employeeCode").value;

    // تشكيل الرابط للحصول على البيانات
    var url = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${employeeCode}!A:Z?key=${apiKey}`;

    // إجراء الطلب للحصول على البيانات
    fetch(url)
        .then(response => response.json())
        .then(data => findEmployeeData(data))
        .catch(error => {
            console.error('Error fetching data:', error);
            alert('Error fetching data. Please check the console for details.');
        });
}

function findEmployeeData(data) {
    if (data && data.values && data.values.length > 0) {
        // قم بمعالجة البيانات كما هو مطلوب
        // يمكنك استخدام data.values للوصول إلى القيم في الخلايا
    } else {
        console.log('No data available in the sheet');
        alert('No data available for the provided employee code.');
    }
}

  </script>
</body>
</html>
